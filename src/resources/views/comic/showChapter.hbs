<div class="container">
    <div class="row">
        <div class="container mt-4 col-12 col-lg-12 col-xl-12">
            <ul class="breadcrumb">
                <li id="breadcrumb-item-home" class="breadcrumb-item" style="margin-left: -20px;">
                    <a href="/">
                        <i class="fa fa-home" aria-hidden="true"></i>
                        Home
                    </a>
                    <div class="triangle"></div>
                </li>
                <li id="breadcrumb-item-list" class="breadcrumb-item d-none d-sm-block d-lg-block">
                    <a href="/list-comic">
                        Danh sách truyện
                    </a>
                    <div class="triangle"></div>
                </li>
                <li id="breadcrumb-item-comic" class="breadcrumb-item d-none d-sm-block d-lg-block">
                    <a id="breadcrumb-name-comic" href="/comic/{{chapter.slugComic}}">{{chapter.slugComic}}</a>
                    <div class="triangle"></div>
                </li>
                <li id="breadcrumb-item-chapter" class="breadcrumb-item breadcrumb-item-active">
                    <a id="breadcrumb-name-chapter" href="#">{{chapter.name}}</a>
                    <div class="triangle"></div>
                </li>
            </ul>
        </div>

        <div class="navigation col-12 col-lg-12 col-xl-12">
            <a href="/comic/{{chapter.slugComic}}/{{chapter.preChapter}}">
                <button style="padding: 20px;"><i class="fa fa-arrow-left" aria-hidden="true"></i></button>
            </a>
            <button onclick="showListChapter(`listChapter`)" style="padding: 20px;"><i class="fa fa-bars" aria-hidden="true"></i></button>
            <a href="/comic/{{chapter.slugComic}}/{{chapter.nextChapter}}">
                <button style="padding: 20px;"><i class="fa fa-arrow-right" aria-hidden="true"></i></button>
            </a>
            <ul id="listChapter">
            {{#each listChapters}}
                <a href="/comic/{{this.slugComic}}/{{this.slugChapter}}">{{this.name}}</a>
            {{/each}}
            </ul>
        </div>

        <div class="col-12 col-lg-12 col-xl-12">
            <div id="chapter-comic-image">
                {{#each listImageChapter}}
                    <img src="{{this}}" alt="">
                {{/each}}
            </div>
        </div>

        <div class="navigation navigation-scroll-up col-12 col-lg-12 col-xl-12">
            <div class="row">
                <a href="/comic/{{chapter.slugComic}}/{{chapter.preChapter}}" class="col-3 navigation-scroll-up-item">
                    <i class="fa fa-arrow-left" aria-hidden="true"></i>
                </a>
                <a href="/" class="col-3 navigation-scroll-up-item">
                    <i class="fas fa-home    "></i>
                </a>
                <div onclick="showListChapter(`list-chapter-left`)" class="col-3 navigation-scroll-up-item">
                    <i class="fas fa-list    "></i>
                </div>
                <a href="/comic/{{chapter.slugComic}}/{{chapter.nextChapter}}" class="col-3 navigation-scroll-up-item">
                    <i class="fa fa-arrow-right" aria-hidden="true"></i>
                </a>
                <ul id="list-chapter-left">
                    <div class="row list-chapter-left-comic">
                        <a href="{{comic.slug}}"  class="col-4">
                            <img src="{{comic.urlImage}}" alt="">
                        </a>
                        <a href="{{comic.slug}}" class="col-8">
                            <span>{{comic.name}}</span>
                        </a>
                    </div>
                    {{#each listChapters}}
                        <a href="/comic/{{this.slugComic}}/{{this.slugChapter}}" class="list-chapter-left-chapter">{{this.name}}</a>
                    {{/each}}
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
    function countViewPage() {
        let slug = url => new URL(url).pathname.match(/[^\/]+/g)
        var slugNameComic = `countViewPageComic-${slug(window.location.href)[1]}`

        // lứu ý thằng key= chỉ nhận tối đa 64 ký tự 
        if(slugNameComic.length > 64) {
            slugNameComic = slugNameComic.substring(0, 63)
        }

        fetch(`https://api.countapi.xyz/update/laptop/${slugNameComic}/?amount=1`)
            .then((res) => res.json())
            .then((res) => {
                if(res.value == null) {
                    fetch(`https://api.countapi.xyz/create?namespace=laptop&key=${slugNameComic}&value=0`)
                        .then((res), countViewPage())
                }
            })
    }
    countViewPage()

    var lastPosition = 0
    window.addEventListener("scroll", () => {
        var curPosition = window.pageYOffset || document.documentElement.scrollTop

        if(curPosition >= lastPosition) {
            document.querySelector('.navigation-scroll-up').style.opacity = '0'

            console.log('luot xuong')
        } else {
            document.querySelector('.navigation-scroll-up').style.opacity = '1'
            {{!-- document.getElementsByClassName('navigation-scroll-up').style.display = 'block' --}}
            console.log('luot len')
        }
        lastPosition = curPosition <= 0 ? 0 : curPosition
    })


    count = 0
    function showListChapter(idTag) {
        count = count + 1
        if(count % 2 == 0)
        {
            document.getElementById(`${idTag}`).style.display = 'none'
        }else {
            document.getElementById(`${idTag}`).style.display = 'block'
        }
    }

</script>